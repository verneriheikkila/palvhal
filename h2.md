# h2 Karjaa

## Cattle, not pets.

**Slater 2017: [Mikä on "karjan, joka ei ole lemmikkieläin" määritelmä?](https://devops.stackexchange.com/questions/653/what-is-the-definition-of-cattle-not-pets#654)**

- "Lemmikit" ovat palvelimia, joita pidetään korvaamattomina ja konfiguroidaan manuaalisesti.
- "Karja" on automaatiotyökaluilla rakennettu palvelinkokoelma, joka kestää palvelinten vikaantumiset ilman ihmisen väliintuloa.

**Karvinen 2017: [Vagrant Revisited - Asenna ja käynnistä uusi virtuaalikone 31 sekunnissa](https://terokarvinen.com/2017/04/11/vagrant-revisited-install-boot-new-virtual-machine-in-31-seconds/)**

- Opas Vagrantin ja VirtualBoxin asentamiseen Linuxiin, uuden virtuaalikoneen käynnistämiseen ja yhdistymiseen SSH:n kautta sekä virtuaalikoneen tuhoamiseen.

**Karvinen 2023: [Salt Vagrant - Ota automaattisesti käyttöön yksi master ja kaksi slavea](https://terokarvinen.com/2023/salt-vagrant/)**

- Artikkeli selittää, miten voit käyttää valmista verkkoa, joka sisältää kolme virtuaalikonetta (master ja kaksi slavea) Saltin kanssa.
- Siinä annetaan vaiheittaiset ohjeet, kuten virtuaaliympäristön asennus, virtuaalikoneiden käynnistys, orjakoneiden avainten hyväksyminen ja virtuaalikoneiden tuhoaminen.

### a) Asenna Vagrant. (Toiminee parhaiten isäntäkäyttöjärjestelmässä, siis siinä, joka pyörii raudalla)

Seurasin ohjeita sivulla:
[Official Vagrant Installation Document](https://developer.hashicorp.com/vagr)

Latasin levykuvan windows käyttäjälle virallisesta Vagrant asennus Windows amd64 arkkitehtuurille [linkistä](https://releases.hashicorp.com/vagrant/2.4.0/vagrant_2.4.0_windows_amd64.msi) ohjeiden mukaisesti.

Varmistin että HyperV on pois päällä hakemalla Windows haulla "Turn Windows features on or off" ja tarkistamalla, että kohdassa:

\*[ ]Windows Hypervisor Platform

Ei ollut raksia ruudussa. Jatkoin suorittamaan ladatun asennustiedoston. Installer oli verrattaen yksinkertainen – tarvitsi sen ajettuaan klikata "Install" sekä "Finish". Tämän jälkeen asennusohjelma ilmoitti vielä, että tietokone tulee käynnistää uudestaan jotta järjestelmäkonfiguraatioon tehdyt muutokset tulevat voimaan.
Kysyi vielä kauniisti, että saako hän suorittaa tämän kunnian. Vastasin kyllä ja odotin, että järjestelmä käynnistyy uudestaan.

Asennuksen tulisi olla valmis koneen käynnistyttyä uudestaan. Katsotaan miten käy.

### b) Yksi maankiertäjä. Asenna yksi kone Vagrantilla, ota siihen SSH-yhteys, osoita että netti toimii.

### c) Oma orjansa. Asenna Salt herra ja orja samalle koneelle.

### d) Asenna Saltin herra-orja arkkitehtuuri toimimaan verkon yli.

### e) Aja useita idempotentteja (state.single) komentoja verkon yli.

### f) Kerää teknistä tietoa orjista verkon yli (grains.item)

### g) Aja shell-komento orjalla verkon yli.

### h) Hello, IaC. Tee infraa koodina kirjoittamalla /srv/salt/hello/init.sls. Aja tila jollekin orjalle. Tila voi esimerkiksi tehdä esimerkkitiedoston johonkin hakemistoon. Testaa toisella komennolla, että pyytämäsi muutos on todella tehty.
